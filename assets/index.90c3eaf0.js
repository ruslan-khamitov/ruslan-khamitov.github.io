var e=Object.defineProperty,t=Object.prototype.hasOwnProperty,a=Object.getOwnPropertySymbols,s=Object.prototype.propertyIsEnumerable,i=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,c=(e,c)=>{for(var r in c||(c={}))t.call(c,r)&&i(e,r,c[r]);if(a)for(var r of a(c))s.call(c,r)&&i(e,r,c[r]);return e};import{c as r,u as l,d as n,a as u,b as o,o as h,w as d,r as p,e as m,t as v,m as f,f as C,F as V,g as b,h as w,v as g,i as y,j as x,k as _,l as k,n as R,p as O}from"./vendor.c08d1c87.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const s=new URL(e,location),i=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,c)=>{const r=new URL(e,s);if(self[t].moduleMap[r])return a(self[t].moduleMap[r]);const l=new Blob([`import * as m from '${r}';`,`${t}.moduleMap['${r}']=m;`],{type:"text/javascript"}),n=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(l),onerror(){c(new Error(`Failed to import: ${e}`)),i(n)},onload(){a(self[t].moduleMap[r]),i(n)}});document.head.appendChild(n)})),self[t].moduleMap={}}}("/assets/");class N{constructor(e){this._current=!1,this._is_changing=!1,this.listeners=[],this.name=e}get current(){return this._current}set current(e){this._current=e,this._is_changing||(this._is_changing=!0,this.listeners&&this.listeners.forEach((t=>{t.handler(e)})),this._is_changing=!1)}subscribe(e){this.listeners.includes(e)||this.listeners.push(e)}unsubscribe(e){const t=this.listeners.indexOf(e);t>-1&&this.listeners.splice(t,1)}}class j{constructor(e){this.current=!1,this._currentValue=null,this.values=new Map,this.name=e}get currentValue(){return this._currentValue}set currentValue(e){this._currentValue!=e&&(this._currentValue&&(this._currentValue.current=!1,this.current=!1),e&&(e.current=!0,this.current=!0),this._currentValue=e),this._currentValue=e}setCurrentValue(e){if(e){let t=this.values.get(e);t||(t=this.appendValue(e)),t&&(this.currentValue=t)}else this.currentValue=null}appendValue(e){return e&&this.values.set(e,new N(e)),this.values.get(e)}toObject(){var e,t;const a=null!=(t=null==(e=this.currentValue)?void 0:e.name)?t:null,s=Array.from(this.values.values(),(e=>({name:e.name,current:e.current})));return{name:this.name,current:this.current,currentValue:a,values:s}}}class D{constructor(e,t,a,s,i){this.number=e,this.expectedCharacteristic=t,this.expectedValue=a,this.finalCharacteristic=s,this.finalValue=i,a.subscribe(this)}handler(e){this.finalCharacteristic.currentValue=e?this.finalValue:null}toObject(){return{expectedCharacteristic:this.expectedCharacteristic.name,expectedValue:this.expectedValue.name,finalCharacteristic:this.finalCharacteristic.name,finalValue:this.finalValue.name}}}const $=r({mutations:{loadData(e){e.session.loadData()},saveData(e){e.session.saveData()}},state:{session:new class{constructor(){this.charecteristics=new Map,this.rules=new Map}loadData(){var e,t;const a=JSON.parse(null!=(e=this.getCookie("charecteristics"))?e:"[]");this.loadCharacteristics(a),console.log(Array.from(this.charecteristics.values(),(e=>e.toObject())));const s=JSON.parse(null!=(t=this.getCookie("rules"))?t:"[]");this.loadRules(s),console.log(Array.from(this.rules.values(),(e=>e.toObject())))}loadCharacteristics(e){e instanceof Array&&e.forEach((e=>{const t=this.appendCharacteristic(e.name);if(t){const a=e.values;a instanceof Array&&a.forEach((e=>{t.appendValue(e.name)}));const s=e.currentValue;s&&t.setCurrentValue(s)}}))}loadRules(e){e instanceof Array&&e.forEach((e=>{const t=e.expectedCharacteristic,a=e.expectedValue,s=e.finalCharacteristic,i=e.finalValue;this.appendRule(t,a,s,i)}))}saveData(){try{const e=JSON.stringify(Array.from(this.charecteristics.values(),(e=>e.toObject())));this.setCookie("charecteristics",e);const t=JSON.stringify(Array.from(this.rules.values(),(e=>e.toObject())));this.setCookie("rules",t)}catch(e){console.error(e)}}getCookie(e){let t=document.cookie.match(new RegExp(`(?:^|; )${e.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,"\\$1")}=([^;]*)`));return t?decodeURIComponent(t[1]):void 0}setCookie(e,t){document.cookie=`${encodeURIComponent(e)}=${encodeURIComponent(t)};`}clearCookie(e){document.cookie=`${e}=;max-age=-1`}appendCharacteristic(e){return null!=e&&e.trim().length&&!this.charecteristics.has(e)&&this.charecteristics.set(e,new j(e)),this.charecteristics.get(e)}appendRule(e,t,a,s){const i=this.charecteristics.get(e),c=this.charecteristics.get(a);if(i&&c){const e=i.values.get(t),a=c.values.get(s);if(e&&a){const t=`${i.name}|${e.name}|${c.name}|${a.name}`;this.rules.has(t)||this.rules.set(t,new D(this.rules.size,i,e,c,a))}}}}}}),U=Symbol();function A(){return l(U)}var E=n({name:"App"});const S={class:"home-page"},L=m("ЛР 1"),M=m("ЛР 2");E.render=function(e,t,a,s,i,c){const r=p("router-link");return h(),u("div",S,[o(r,{to:"/characteristics"},{default:d((()=>[L])),_:1}),o(r,{to:"/rules"},{default:d((()=>[M])),_:1})])};var I=n({name:"Characteristic",props:{characteristic:{type:Object,default:()=>new j("")},isSelected:{type:Boolean,required:!0,default:()=>!1}},methods:{select(){this.$emit("select-characteristic",this.characteristic)}}});I.render=function(e,t,a,s,i,c){return h(),u("div",{class:{characteristic:!0,characteristic_selected:e.isSelected},onClick:t[1]||(t[1]=(...t)=>e.select&&e.select(...t))},v(e.characteristic.name),3)};var F=n({name:"Characteristic",props:{value:{type:Object,default:()=>new N("")}},methods:{select(){this.$emit("select-value",this.value)}}});F.render=function(e,t,a,s,i,c){return h(),u("div",{class:"value",onClick:t[1]||(t[1]=(...t)=>e.select&&e.select(...t))},v(e.value.name),1)};var P=n({name:"Characteristics",components:{Characteristic:I,Value:F},data:()=>({newCharacteristicName:"",newValueName:"",characteristic:void 0}),methods:c(c({},f(["saveData"])),{addNewCharacteristic(){this.session.appendCharacteristic(this.newCharacteristicName.trim()),this.newCharacteristicName=""},addValue(){null!=this.selectCharacteristic&&null!=this.characteristic&&(this.characteristic.setCurrentValue(this.newValueName.trim()),this.newValueName="")},selectValue(e){null!=this.selectCharacteristic&&null!=this.characteristic&&this.characteristic.setCurrentValue(e.name)},selectCharacteristic(e){this.characteristic=e}}),mounted(){document.addEventListener("beforeunload",this.saveData)},setup(){const e=A();return{session:C((()=>e.state.session)),saveData:()=>e.commit("saveData")}}});const B={class:"characteristics-page"},J={class:"characteristics-list"},q=o("h3",null,"Характеристики:",-1),z={class:"characteristics"},G={class:"characteristics__new"},H=o("label",{for:"newCharacteristic"}," Добавить новую характеристику: ",-1),K={key:0,class:"characteristic-values"},Q={class:"values"},T=o("h4",null,"Значения:",-1),W={class:"selected-characteristic__values"},X={class:"new-value"},Y=o("label",{for:"newValueInput"},"Добавьте новое значение",-1),Z={class:"selected-characteristic__new-value"};P.render=function(e,t,a,s,i,c){const r=p("characteristic"),l=p("value");return h(),u("div",B,[o("section",J,[q,o("div",z,[(h(!0),u(V,null,b(e.session.charecteristics.entries(),(([t,a])=>(h(),u(r,{key:t,characteristic:a,"is-selected":a===e.characteristic,onSelectCharacteristic:e.selectCharacteristic},null,8,["characteristic","is-selected","onSelectCharacteristic"])))),128))]),o("div",G,[H,w(o("input",{type:"text",id:"newCharacteristic","onUpdate:modelValue":t[1]||(t[1]=t=>e.newCharacteristicName=t)},null,512),[[g,e.newCharacteristicName]]),o("button",{onClick:t[2]||(t[2]=(...t)=>e.addNewCharacteristic&&e.addNewCharacteristic(...t))}," Добавить ")])]),null!=e.characteristic?(h(),u("section",K,[o("h3",null,"Характеристика: "+v(e.characteristic.name),1),o("div",Q,[T,o("div",W,[(h(!0),u(V,null,b(e.characteristic.values.entries(),(([t,a])=>(h(),u(l,{key:t,value:a,onSelectValue:t=>e.selectValue(a)},null,8,["value","onSelectValue"])))),128))])]),o("div",X,[Y,o("div",Z,[w(o("input",{id:"newValueInput",type:"text","onUpdate:modelValue":t[3]||(t[3]=t=>e.newValueName=t)},null,512),[[g,e.newValueName]]),o("button",{onClick:t[4]||(t[4]=(...t)=>e.addValue&&e.addValue(...t))}," Добавить ")])])])):y("",!0)])};var ee=n({name:"RulesPage",setup(){const e=A(),t=C((()=>e.state.session)),a=C((()=>e.state.session.charecteristics)),s=C((()=>e.state.session.rules)),i=x(""),c=x(""),r=x(""),l=x(""),n=x(null),u=[["0",new N("Выберите характеристику")]],o=C((()=>{var e,t,s;const i=null==(s=null==(t=null==(e=a.value.get(r.value))?void 0:e.values)?void 0:t.entries)?void 0:s.call(t);return null!=i?Array.from(i):u})),h=C((()=>{var e,t,s;const c=null==(s=null==(t=null==(e=a.value.get(i.value))?void 0:e.values)?void 0:t.entries)?void 0:s.call(t);return null!=c?Array.from(c):u})),d=C((()=>!(i.value.trim().length&&r.value.trim().length&&c.value.trim().length&&l.value.trim().length)));return{session:t,characteristics:a,rules:s,expectedCharacteristic:i,expectedValue:c,finalCharacteristic:r,finalValue:l,selectedRule:n,getFinalValues:o,getExpectedValues:h,isAddButtonDisabled:d}},methods:{addNewRule(){const{expectedCharacteristic:e,finalCharacteristic:t,finalValue:a,expectedValue:s}=this;this.session.appendRule(e,s,t,a),this.expectedCharacteristic="",this.finalCharacteristic="",this.expectedValue="",this.finalValue=""},selectRule(e){this.selectedRule=e}}});const te={class:"rules-page"},ae={class:"rules-list"},se=o("h3",null,"Список правил:",-1),ie={class:"rules-list__list"},ce={class:"new-rule-constructor"},re=o("h3",null,"Новое правило:",-1),le={class:"new-rule"},ne=o("label",{for:"expectedCharacteristic"},"Если:",-1),ue=o("option",{value:""},"Выберите",-1),oe=o("label",{for:"expectedValue"},"Равно:",-1),he=o("option",{value:""},"Выберите",-1),de=o("label",{for:"finalCharacteristic"},"Тогда:",-1),pe=o("option",{value:""},"Выберите",-1),me=o("label",{for:"finalValue"},"Равно:",-1),ve=o("option",{value:""},"Выберите",-1),fe=o("h3",null,"Выбранное правило:",-1),Ce={key:0,class:"display-rule"},Ve={key:1};ee.render=function(e,t,a,s,i,c){return h(),u("div",te,[o("section",ae,[se,o("div",ie,[(h(!0),u(V,null,b(e.rules.entries(),(([t,a])=>(h(),u("div",{class:["rule",a==e.selectedRule?"rule_selected":""],key:t,onClick:t=>e.selectRule(a)}," Правило №"+v(a.number+1),11,["onClick"])))),128))])]),o("section",ce,[re,o("div",le,[o("div",null,[ne,w(o("select",{id:"expectedCharacteristic","onUpdate:modelValue":t[1]||(t[1]=t=>e.expectedCharacteristic=t)},[ue,(h(!0),u(V,null,b(e.characteristics.entries(),(([e,t])=>(h(),u("option",{key:e,value:e},v(t.name),9,["value"])))),128))],512),[[_,e.expectedCharacteristic]])]),o("div",null,[oe,w(o("select",{id:"expectedValue","onUpdate:modelValue":t[2]||(t[2]=t=>e.expectedValue=t),disabled:!e.expectedCharacteristic.length||!e.characteristics.has(e.expectedCharacteristic)},[he,(h(!0),u(V,null,b(e.getExpectedValues,(([e,t])=>(h(),u("option",{key:e,value:e},v(t.name),9,["value"])))),128))],8,["disabled"]),[[_,e.expectedValue]])]),o("div",null,[de,w(o("select",{id:"finalCharacteristic","onUpdate:modelValue":t[3]||(t[3]=t=>e.finalCharacteristic=t)},[pe,(h(!0),u(V,null,b(e.characteristics.entries(),(([e,t])=>(h(),u("option",{key:e,value:e},v(t.name),9,["value"])))),128))],512),[[_,e.finalCharacteristic]])]),o("div",null,[me,w(o("select",{id:"finalValue","onUpdate:modelValue":t[4]||(t[4]=t=>e.finalValue=t),disabled:!e.finalCharacteristic.length||!e.characteristics.has(e.finalCharacteristic)},[ve,(h(!0),u(V,null,b(e.getFinalValues,(([e,t])=>(h(),u("option",{key:e,value:e},v(t.name),9,["value"])))),128))],8,["disabled"]),[[_,e.finalValue]])])]),o("button",{disabled:e.isAddButtonDisabled,onClick:t[5]||(t[5]=(...t)=>e.addNewRule&&e.addNewRule(...t))}," Сохранить ",8,["disabled"])]),o("section",null,[fe,null!=e.selectedRule?(h(),u("div",Ce,' Если "'+v(e.selectedRule.expectedCharacteristic.name)+'" = '+v(e.selectedRule.expectedValue.name)+', тогда "'+v(e.selectedRule.finalCharacteristic.name)+'" = '+v(e.selectedRule.finalValue.name)+", ",1)):(h(),u("div",Ve," Выберите правило из списка слева "))])])};const be=[{path:"/",component:E},{path:"/characteristics",component:P},{path:"/rules",component:ee}];var we=k({history:R(),routes:be}),ge=n({name:"App",setup(){const e=A();return{loadData:()=>e.commit("loadData"),saveData:()=>e.commit("saveData")}},created(){this.loadData(),window.addEventListener("beforeunload",(e=>{this.saveData()}))}});ge.render=function(e,t,a,s,i,c){const r=p("router-view");return h(),u(r)};const ye=O(ge);ye.use($,U),ye.use(we),ye.mount("#app");
